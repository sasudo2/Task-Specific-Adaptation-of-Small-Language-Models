[I 2026-02-04 17:22:22,860] A new study created in memory with name: no-name-a2e8de81-ca9a-4645-a3fc-42762c452dd3
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:04<00:00, 282.14it/s, Materializing param=model.norm.weight]
Changes to your `wandb` environment variables will be ignored because your `wandb` session has already started. For more information on how to modify your settings with `wandb.init()` arguments, please refer to the W&B docs.
Tracking run with wandb version 0.24.1
Run data is saved locally in /content/wandb/run-20260204_172229-c0v56mp7
Syncing run lucky-butterfly-5 to Weights & Biases (docs)
View project at https://wandb.ai/sanjayashrestha777-thapathali-campus/huggingface
View run at https://wandb.ai/sanjayashrestha777-thapathali-campus/huggingface/runs/c0v56mp7
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [112/112 07:24, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.974616	0.752050
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 17:30:11,506] Trial 0 finished with value: 0.7511105537414551 and parameters: {'per_device_train_batch_size': 15, 'warmup_steps': 1, 'learning_rate': 0.00038916315600967283, 'r': 64, 'lora_alpha': 16, 'target_modules': ['v_proj', 'k_proj']}. Best is trial 0 with value: 0.7511105537414551.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 290.24it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [130/130 07:27, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.946008	0.737609
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 17:37:59,750] Trial 1 finished with value: 0.7325910925865173 and parameters: {'per_device_train_batch_size': 13, 'warmup_steps': 9, 'learning_rate': 0.00043482996384774496, 'r': 8, 'lora_alpha': 64, 'target_modules': ['q_proj', 'v_proj']}. Best is trial 1 with value: 0.7325910925865173.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 275.89it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [154/154 07:32, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.967519	0.745764
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 17:45:52,162] Trial 2 finished with value: 0.7376483082771301 and parameters: {'per_device_train_batch_size': 11, 'warmup_steps': 2, 'learning_rate': 0.00035324135170089406, 'r': 32, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj']}. Best is trial 1 with value: 0.7325910925865173.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 304.83it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [336/336 08:42, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.480826	0.998782
200	0.977575	0.825302
300	0.932375	0.812989
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 17:54:52,509] Trial 3 finished with value: 0.8122608661651611 and parameters: {'per_device_train_batch_size': 5, 'warmup_steps': 3, 'learning_rate': 2.609609725569948e-05, 'r': 32, 'lora_alpha': 16, 'target_modules': ['q_proj', 'v_proj']}. Best is trial 1 with value: 0.7325910925865173.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 252.57it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [210/210 08:07, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.156350	0.800316
200	0.913853	0.781222
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 18:03:18,940] Trial 4 finished with value: 0.7810811400413513 and parameters: {'per_device_train_batch_size': 8, 'warmup_steps': 3, 'learning_rate': 8.487335505566941e-05, 'r': 16, 'lora_alpha': 16, 'target_modules': ['v_proj', 'k_proj']}. Best is trial 1 with value: 0.7325910925865173.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 249.79it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [840/840 11:16, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.034535	0.785148
200	0.856894	0.760201
300	0.844204	0.749615
400	0.834703	0.742080
500	0.794895	0.735777
600	0.760470	0.732943
700	0.772668	0.728682
800	0.841325	0.726364
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 18:14:52,756] Trial 5 finished with value: 0.7260868549346924 and parameters: {'per_device_train_batch_size': 2, 'warmup_steps': 7, 'learning_rate': 0.0003737918942333893, 'r': 32, 'lora_alpha': 8, 'target_modules': ['q_proj', 'v_proj']}. Best is trial 5 with value: 0.7260868549346924.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 288.75it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [280/280 08:42, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.111424	0.784388
200	0.877004	0.759822
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 18:23:53,791] Trial 6 finished with value: 0.7556001543998718 and parameters: {'per_device_train_batch_size': 6, 'warmup_steps': 10, 'learning_rate': 5.3493541463695194e-05, 'r': 16, 'lora_alpha': 64, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}. Best is trial 5 with value: 0.7260868549346924.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 278.97it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [469/560 08:17 < 01:36, 0.94 it/s, Epoch 1.67/2]
Step	Training Loss	Validation Loss
100	1.485919	1.056153
200	1.020489	0.871650
300	0.949925	0.855784
400	0.936468	0.848457
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [560/560 09:58, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.485919	1.056153
200	1.020489	0.871650
300	0.949925	0.855784
400	0.936468	0.848457
500	0.952345	0.845031
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 18:34:10,708] Trial 7 finished with value: 0.8446041345596313 and parameters: {'per_device_train_batch_size': 3, 'warmup_steps': 7, 'learning_rate': 5.326908191253073e-05, 'r': 64, 'lora_alpha': 16, 'target_modules': ['q_proj', 'k_proj']}. Best is trial 5 with value: 0.7260868549346924.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 255.82it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [280/280 08:21, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.947063	0.746949
200	0.821824	0.731603
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 18:42:50,612] Trial 8 finished with value: 0.7253598570823669 and parameters: {'per_device_train_batch_size': 6, 'warmup_steps': 0, 'learning_rate': 0.00035661001923737655, 'r': 8, 'lora_alpha': 64, 'target_modules': ['v_proj', 'k_proj']}. Best is trial 8 with value: 0.7253598570823669.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 263.97it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [420/420 09:14, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.103035	0.786133
200	0.886031	0.763015
300	0.842661	0.750613
400	0.879128	0.746505
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 18:52:22,928] Trial 9 finished with value: 0.7464359402656555 and parameters: {'per_device_train_batch_size': 4, 'warmup_steps': 7, 'learning_rate': 0.00012888184615615113, 'r': 16, 'lora_alpha': 16, 'target_modules': ['v_proj', 'k_proj']}. Best is trial 8 with value: 0.7253598570823669.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 291.56it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [188/188 07:36, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.975198	0.792586
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:00:18,394] Trial 10 finished with value: 0.7841811180114746 and parameters: {'per_device_train_batch_size': 9, 'warmup_steps': 0, 'learning_rate': 0.0009095231413068411, 'r': 8, 'lora_alpha': 64, 'target_modules': ['q_proj', 'k_proj']}. Best is trial 8 with value: 0.7253598570823669.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 304.85it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [840/840 11:41, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.090648	0.791879
200	0.864656	0.769716
300	0.852278	0.757387
400	0.842039	0.750064
500	0.811484	0.743045
600	0.780346	0.739517
700	0.794015	0.736268
800	0.861096	0.734090
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:12:17,547] Trial 11 finished with value: 0.7339389324188232 and parameters: {'per_device_train_batch_size': 2, 'warmup_steps': 5, 'learning_rate': 0.00018764919122003519, 'r': 32, 'lora_alpha': 8, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}. Best is trial 8 with value: 0.7253598570823669.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 262.41it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [240/240 08:11, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.977238	0.747223
200	0.829191	0.730312
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:20:47,402] Trial 12 finished with value: 0.7283551096916199 and parameters: {'per_device_train_batch_size': 7, 'warmup_steps': 6, 'learning_rate': 0.0009850723354302667, 'r': 8, 'lora_alpha': 8, 'target_modules': ['q_proj', 'v_proj']}. Best is trial 8 with value: 0.7253598570823669.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 274.13it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [840/840 11:14, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.079889	0.793456
200	0.863934	0.768352
300	0.851864	0.756934
400	0.842263	0.749992
500	0.811750	0.742845
600	0.780902	0.739720
700	0.794336	0.736021
800	0.860941	0.733956
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:32:18,995] Trial 13 finished with value: 0.7337584495544434 and parameters: {'per_device_train_batch_size': 2, 'warmup_steps': 5, 'learning_rate': 0.00021916681928189837, 'r': 8, 'lora_alpha': 8, 'target_modules': ['v_proj', 'k_proj']}. Best is trial 8 with value: 0.7253598570823669.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 262.96it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [336/336 08:41, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.984435	0.753112
200	0.850014	0.734094
300	0.799288	0.724434
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:41:18,875] Trial 14 finished with value: 0.7234758138656616 and parameters: {'per_device_train_batch_size': 5, 'warmup_steps': 8, 'learning_rate': 0.0004788578660188426, 'r': 32, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj']}. Best is trial 14 with value: 0.7234758138656616.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 270.46it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [168/168 07:32, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.559366	1.331030
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:49:11,341] Trial 15 finished with value: 1.1216356754302979 and parameters: {'per_device_train_batch_size': 10, 'warmup_steps': 9, 'learning_rate': 1.415716857725099e-05, 'r': 32, 'lora_alpha': 32, 'target_modules': ['v_proj', 'k_proj']}. Best is trial 14 with value: 0.7234758138656616.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 293.32it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [280/280 08:40, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.957875	0.747675
200	0.806890	0.731050
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 19:58:11,154] Trial 16 finished with value: 0.7237014770507812 and parameters: {'per_device_train_batch_size': 6, 'warmup_steps': 4, 'learning_rate': 0.0007233760469270178, 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}. Best is trial 14 with value: 0.7234758138656616.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 279.95it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [336/336 09:04, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.961267	0.747209
200	0.837185	0.731138
300	0.765080	0.723101
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 20:07:34,780] Trial 17 finished with value: 0.7210278511047363 and parameters: {'per_device_train_batch_size': 5, 'warmup_steps': 4, 'learning_rate': 0.000649330450809472, 'r': 64, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}. Best is trial 17 with value: 0.7210278511047363.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 292.06it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [420/420 09:39, Epoch 2/2]
Step	Training Loss	Validation Loss
100	0.973979	0.757095
200	0.859573	0.733282
300	0.756147	0.728646
400	0.778284	0.721372
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 20:17:33,327] Trial 18 finished with value: 0.7210537791252136 and parameters: {'per_device_train_batch_size': 4, 'warmup_steps': 8, 'learning_rate': 0.0006062460984301994, 'r': 64, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}. Best is trial 17 with value: 0.7210278511047363.
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['q_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
/tmp/ipython-input-840045513.py:29: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains ['v_proj', 'k_proj'] which is of type list.
  target_modules = trial.suggest_categorical("target_modules", [["q_proj", "v_proj"], ["q_proj", "v_proj", "k_proj"], ["q_proj", "k_proj"], ["v_proj", "k_proj"]]),
Loading weights: 100%
 291/291 [00:03<00:00, 293.60it/s, Materializing param=model.norm.weight]
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [420/420 09:39, Epoch 2/2]
Step	Training Loss	Validation Loss
100	1.005994	0.764641
200	0.867642	0.744022
300	0.806633	0.735136
400	0.839624	0.729179
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:1181: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [50/50 00:10]
[I 2026-02-04 20:27:31,347] Trial 19 finished with value: 0.729016125202179 and parameters: {'per_device_train_batch_size': 4, 'warmup_steps': 5, 'learning_rate': 0.00020522232426404557, 'r': 64, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}. Best is trial 17 with value: 0.7210278511047363.
Best hyperparameters: {'per_device_train_batch_size': 5, 'warmup_steps': 4, 'learning_rate': 0.000649330450809472, 'r': 64, 'lora_alpha': 32, 'target_modules': ['q_proj', 'v_proj', 'k_proj']}